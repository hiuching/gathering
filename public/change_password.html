<!DOCTYPE html>
<style>
#main {
	width: 100%;
	height:100%;
}
#container {
	margin-left: 45%;
	margin-top: 15%;
}
#msg{
	color: red;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20150503/json2.min.js"></script>
<script src="js/jstorage.js"></script>
<script>
	$(document).ready(function() {
		//var userId = $.jStorage.get("userId");
		var userId = "56027b3c8ff1db68160fe356";
		$('#submit').click(function() {
			if ($('#newPw').val() == '' || $('#confirmPw').val() == '')
				return;
			if ($('#newPw').toString().length < 8 || $('#newPw').toString().length > 16){
				$('#msg').text ("The length of password need to be longer than 8chars and shorter than 16chars!");
				console.log($('#newPw').toString().length);
				return;
			}
			if ($('#newPw').val() != $('#confirmPw').val()){
				$('#msg').text ("The new password is not same to the confirmed password");
				return;
			}
			var data = {
				//email: $.jStorage.get("userEmail");
				email: "carrie_ho_1@hotmail.com",
				password: $('#newPw').val()
			}
			$.support.cors = true;
			/*$.ajax({
				type: 'GET',
				contentType: 'application/json',
				url: 'http://ec2-52-68-199-65.ap-northeast-1.compute.amazonaws.com:8081/gathering/user/action=findUserByEmailWithPassword,
				data: confirm,
				dataType: 'json',
				success: function(user) {
					console.log('success', str);
				},
				error: function(err){
					console.log('failed', err);
					$('#msg').text ("Incorrect password");
					return;
				}
			})*/;
			data = JSON.stringify (data);
			$.ajax({
				type: 'POST',
				contentType: 'application/json',
				url: 'http://ec2-52-68-199-65.ap-northeast-1.compute.amazonaws.com:8081/gathering/user/'+ userId,
				data: data,
				dataType: 'json',
				success: function (user) {
					var str = user.email;
					console.log ('success', str);
					$('#msg').text ("Your password is updates successful.")
				},
				error: function (err){
					console.log ('failed', err);
				}
			});
		});	
	});
</script>
<html>
	<head>
	<title>Gathering</title>
	</head>
	<body>
		<div id = "main">
			<div id = "container">
			New Password: <input type = "text" id = "newPw"/>(min. to 8 characters, max to 16 characters)<br/>
			Confirm New Password:<input type = "text" id = "confirmPw"/><br/>
			<span id = "msg"></span><br/>
			<button type = "submit" id = "submit">Save</button>
			</div>
		</div>

	</body>
</html>