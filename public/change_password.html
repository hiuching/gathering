<!DOCTYPE html>
<style>
#main {
	width: 100%;
	height:100%;
}
#container {
	margin-left: 45%;
	margin-top: 15%;
}
#msg{
	color: red;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20150503/json2.min.js"></script>
<script src="js/jstorage.js"></script>
<script>
	$(document).ready(function() {
		var userId = $.jStorage.get("userId");
		$('#submit').click(function() {
			if ($('#newPw').val() == '' || $('#confirmPw').val() == '')
				return;
			var update = {
				password: $('#newPw').val();
			}
			var confirm = {
				email: $.jStorage.get("userEmail");
				password: $('#confirmPw').val();
			}
			$.support.cors = true;
			$.ajax({
				type: 'GET',
				contentType: 'application/json',
				url: 'http://ec2-52-68-199-65.ap-northeast-1.compute.amazonaws.com:8081/gathering/user/action=findUserByEmailWithPassword,
				data: confirm,
				dataType: 'json',
				success: function(user) {
					console.log('success', str);
				},
				error: function(err){
					console.log('failed', err);
					$('#msg').text ("Incorrect password");
					return;
				}
			});
			data = JSON.stringify (data);
			$.ajax({
				type: 'POST',
				contentType: 'application/json',
				url: 'http://ec2-52-68-199-65.ap-northeast-1.compute.amazonaws.com:8081/gathering/user/' + userId,
				data: update,
				dataType: 'json',
				success: function (user) {
					console.log ('success', str);
					$('#msg').text ("Your password is updates successful.")
				},
				error: function (err){
					console.log ('failed', err);
				}
			});
		});	
	});
</script>
<html>
	<head>
	<title>Gathering</title>
	</head>
	<body>
		<div id = "main">
			<div id = "container">
			New Password: <input type = "text" id = "newPw"/><br/>
			Confirm New Password:<input type = "text" id = "confirmPw"/><br/>
			<span id = "msg"></span><br/>
			<button type = "submit" id = "submit">Save</button>
			</div>
		</div>

	</body>
</html>