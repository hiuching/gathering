<!DOCTYPE html>
<style>
#main {
	width: 100%;
	height:100%;
}
#container {
	margin-left: 45%;
	margin-top: 15%;
}
#msg{
	color: red;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20150503/json2.min.js"></script>
<script src="js/jstorage.js"></script>
<script>
    $(document).ready(function() {
		$("#forget").click(function(){
			document.location.href='register.html?forget';
		});

		$("#register").click(function(){
			document.location.href='register.html?joinUs';
		});

		$('#login').click(function(){
			if ($('#email').val() == "" || $('#password').val() == "") {
				$('#msg').text ("Please fill in both email and password");
				return;
			}
			var data = {
				email: $('#email').val(),
				password: $('#password').val()
			}
			$.support.cors = true;
			$.ajax({
				type: 'GET',
				contentType: 'application/json',
				url: 'http://ec2-52-68-199-65.ap-northeast-1.compute.amazonaws.com:8081/login',
				data: data,
				dataType: 'json',
				success: function(user) {
					var str = 'email:' + user.email;
					console.log('success', str);
					$('#msg').text ("login successful");
					$.jStorage.set("userEmail", user.email);
					window.location.href = 'home.html';
				},
				error: function(err){
					console.log('failed', err);
					$('#msg').text ("Incorrect email or password");
				}
			});
		});
	});
</script>
<html>
	<head>
	<title>Gathering</title>
	</head>
	<body>
		<div id = "main">
			<div id = "container">
				Email: <input type = "text" id = "email"/><br/>
				Password: <input type = "text" id = "password"/><br/>
				<span id = "msg"> </span><br/>
				<button id = "login">login</button><br/>
				<a href = "#" id = "forget">Forget Password?</a>
				<a href = "#" id = "register">Join with us!</a>
			</div>
		</div>

	</body>
</html>
